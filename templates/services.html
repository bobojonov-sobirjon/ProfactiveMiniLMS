{% extends 'base.html' %}
{% load static %}

{% block title %}Услуги - Profactive{% endblock %}

{% block content %}
<!-- Services Page Content -->
<section class="max-sm:pt-15 max-md:pt-20 max-lg:pt-32.5 mb-12 md:mb-20 lg:mb-31">
  <div class="text-center">
    <h1 class="font-bold text-2xl md:text-3xl lg:text-basic-40 mb-8" data-aos="fade-up">
      Наши <span class="text-gradient-display">услуги</span>
    </h1>
    <p class="text-lg text-white/70 max-w-3xl mx-auto" data-aos="fade-up" data-aos-delay="100">
      Мы предлагаем широкий спектр образовательных услуг для всех уровней подготовки
    </p>
  </div>
</section>

<!-- Services Grid -->
<section class="mb-12 md:mb-20 lg:mb-31">
  <div>
    <div x-data="showMore(6)">
      <div
        class="grid sm:grid-cols-2 lg:grid-cols-3 gap-5 md:gap-8 lg:gap-11 mb-6 md:mb-9 lg:mb-13.5 font-semibold" data-aos="fade-up" data-aos-delay="200">
        <!-- Service Cards -->
        {% for service in services %}
        <div class="group bg-white rounded-3xl overflow-hidden" data-aos="fade-up" data-aos-delay="{% cycle '300' '400' '500' '600' '700' '800' %}">
          <div class="h-40 md:h-56 w-full relative overflow-hidden">
            {% if service.image and service.image.url %}
            <img class="relative z-0 size-full object-cover transition duration-200 group-hover:scale-105"
              src="{{ service.image.url }}" alt="{{ service.title }}">
            {% else %}
            <div class="relative z-0 size-full bg-gradient-to-br from-brand-yellow-500/20 to-brand-yellow-600/20 flex items-center justify-center">
              <svg class="w-16 h-16 text-brand-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd" />
              </svg>
            </div>
            {% endif %}
          </div>
          <div class="p-4 lg:p-6">
            <h4 class="text-primary text-lg lg:text-basic-23/8.75 mb-2 md:mb-3.5 break-words">
              {{ service.title }}
            </h4>
            <p class="text-primary/50 lg:text-lg/7 mb-5 md:mb-8 lg:mb-11 font-medium break-words">
              {{ service.description|truncatewords:20 }}
            </p>
          </div>
        </div>
        {% empty %}
        <div class="col-span-full text-center py-20">
          <p class="text-white/50 text-xl">Пока нет услуг</p>
        </div>
        {% endfor %}
      </div>

      {% if services|length > 6 %}
      <div class="text-center">
        <button @click="toggle()" 
                class="bg-gradient-to-r from-brand-yellow-500 to-brand-yellow-600 text-white px-8 py-3 rounded-full font-semibold hover:from-brand-yellow-600 hover:to-brand-yellow-700 transition-all duration-300">
          <span x-text="buttonText"></span>
        </button>
      </div>
      {% endif %}
    </div>
  </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
  .text-gradient-display {
    background: linear-gradient(135deg, #AB803B 0%, #CDB14F 23.53%, #F0E263 49.02%, #D9B84A 73.33%, #C28D31 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
</style>
{% endblock %}

<script>
  function showMore(step = 6) {
    return {
      step,
      visible: step,
      items: [],
      buttonText: "Показать еще услуги",

      init() {
        this.items = this.$el.querySelectorAll(".grid > div");
        this.update();
      },

      update() {
        this.items.forEach((el, i) => {
          el.style.display = i < this.visible ? "block" : "none";
        });

        if (this.visible < this.items.length) {
          this.buttonText = "Показать еще";
        } else {
          this.buttonText = "Скрыть услуги";
        }
      },

      toggle() {
        if (this.visible < this.items.length) {
          this.visible += this.step;
        } else {
          this.visible = this.step;
        }
        this.update();
      }
    }
  }
</script>